<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Universal Data Bridge</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; padding: 30px; background: #f9fafb; color: #1f2937; }
        .container { max-width: 1200px; margin: auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        h1 { margin-top: 0; color: #111827; }
        textarea { width: 100%; height: 180px; margin: 15px 0; border: 1px solid #d1d5db; border-radius: 8px; padding: 15px; font-size: 14px; box-sizing: border-box; resize: vertical; }
        .btn { background: #2563eb; color: white; border: none; padding: 14px 28px; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: 600; width: 100%; transition: background 0.2s; }
        .btn:hover { background: #1d4ed8; }
        .preview-section { margin-top: 40px; display: none; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; }
        th, td { border: 1px solid #e5e7eb; padding: 12px; text-align: left; vertical-align: top; }
        th { background-color: #f3f4f6; font-weight: 600; }
        .code-output { background: #111827; color: #10b981; padding: 20px; border-radius: 8px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; overflow-x: auto; font-size: 13px; margin-top: 10px; border: 1px solid #374151; }
        .row-count { font-weight: bold; color: #2563eb; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Excel & Doc to Extension Bridge</h1>
        <p>Paste your two columns (Justification and Description) from any source below.</p>
        
        <textarea id="bulkPaste" placeholder="Copy-paste rows from Excel, Word, or Google Docs here..."></textarea>
        <button class="btn" onclick="generateBridge()">Transform Data</button>

        <div id="previewSection" class="preview-section">
            <div id="rowCountDisplay" class="row-count"></div>
            
            <h3>1. Extension JSON Code</h3>
            <p>Copy this code and paste it into the Extension Popup:</p>
            <div id="outputCode" class="code-output"></div>

            <h3>2. Visual Verification Table</h3>
            <div id="tableContainer"></div>
        </div>
    </div>

    <script>
        function generateBridge() {
            const input = document.getElementById('bulkPaste').value.trim();
            if (!input) return;

            const lines = input.split('\n');
            const finalData = [];

            lines.forEach(line => {
                // Splits by Tab (Excel) or 2+ Spaces (Word/Docs)
                const columns = line.split(/\t| {2,}/);
                
                if (columns.length >= 1) {
                    const col1 = columns[0].trim();
                    const col2 = columns[1] ? columns[1].trim() : "";
                    
                    // Filters out headers and empty rows
                    if (col1 && col1.toLowerCase() !== "justification") {
                        finalData.push([col1, col2]);
                    }
                }
            });

            // Display Results
            document.getElementById('previewSection').style.display = 'block';
            document.getElementById('rowCountDisplay').innerText = `Rows found: ${finalData.length}`;
            document.getElementById('outputCode').innerText = JSON.stringify(finalData);
            
            // Build table for visual confirmation
            let html = `<table><tr><th>#</th><th>Justification</th><th>Content Description</th></tr>`;
            finalData.forEach((row, i) => {
                html += `<tr><td>${i}</td><td>${row[0]}</td><td>${row[1]}</td></tr>`;
            });
            html += '</table>';
            document.getElementById('tableContainer').innerHTML = html;
        }
    </script>
</body>
</html>
